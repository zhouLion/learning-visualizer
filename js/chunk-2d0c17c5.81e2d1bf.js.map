{"version":3,"sources":["webpack:///./src/views/articles/canvas/chapterC03P01.vue"],"names":[],"mappings":"kHAAA,OAAe","file":"js/chunk-2d0c17c5.81e2d1bf.js","sourcesContent":["export default \"<span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">template</span>&gt;</span>\\n  <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">div</span>&gt;</span>\\n    <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">h2</span>&gt;</span>canvas - 图片处理<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">h2</span>&gt;</span>\\n    <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">p</span>&gt;</span>canvas 上允许你操作图片颜色的红，绿，蓝以及透明度，通过这个，可以实现很多类似 Photoshop 上一样的功能。<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">p</span>&gt;</span>\\n    <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">h3</span>&gt;</span>色彩选择<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">h3</span>&gt;</span>\\n    <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">table</span> <span class=\\\"hljs-attr\\\">class</span>=<span class=\\\"hljs-string\\\">&quot;canvas-demo-table&quot;</span>&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">colgroup</span>&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">col</span> <span class=\\\"hljs-attr\\\">width</span>=<span class=\\\"hljs-string\\\">&quot;50%&quot;</span> /&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">col</span> <span class=\\\"hljs-attr\\\">width</span>=<span class=\\\"hljs-string\\\">&quot;25%&quot;</span> /&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">col</span> <span class=\\\"hljs-attr\\\">width</span>=<span class=\\\"hljs-string\\\">&quot;25%&quot;</span> /&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">colgroup</span>&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">thead</span>&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">tr</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">th</span>&gt;</span>图片<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">th</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">th</span>&gt;</span>鼠标位置像素值<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">th</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">th</span>&gt;</span>选中像素值<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">th</span>&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">tr</span>&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">thead</span>&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">tbody</span>&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">tr</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n            <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">canvas</span>\\n              @<span class=\\\"hljs-attr\\\">mousemove</span>=<span class=\\\"hljs-string\\\">&quot;onmousemove&quot;</span>\\n              @<span class=\\\"hljs-attr\\\">click</span>=<span class=\\\"hljs-string\\\">&quot;onSelect&quot;</span>\\n              <span class=\\\"hljs-attr\\\">ref</span>=<span class=\\\"hljs-string\\\">&quot;canvas&quot;</span>\\n              <span class=\\\"hljs-attr\\\">:width</span>=<span class=\\\"hljs-string\\\">&quot;canvasSize.width&quot;</span>\\n              <span class=\\\"hljs-attr\\\">:height</span>=<span class=\\\"hljs-string\\\">&quot;canvasSize.height&quot;</span>\\n            &gt;</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">canvas</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n            <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">span</span>\\n              <span class=\\\"hljs-attr\\\">:style</span>=<span class=\\\"hljs-string\\\">&quot;{\\n                backgroundColor: hoverColor,\\n                color: &#x27;#eee&#x27;\\n              }&quot;</span>\\n            &gt;</span>{{ hoverColor }}<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">span</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n            <span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">span</span>\\n              <span class=\\\"hljs-attr\\\">:style</span>=<span class=\\\"hljs-string\\\">&quot;{\\n                backgroundColor: selectedColor,\\n                color: &#x27;#eee&#x27;\\n              }&quot;</span>\\n            &gt;</span>{{ selectedColor }}<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">span</span>&gt;</span>\\n          <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">td</span>&gt;</span>\\n        <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">tr</span>&gt;</span>\\n      <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">tbody</span>&gt;</span>\\n    <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">table</span>&gt;</span>\\n  <span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">div</span>&gt;</span>\\n<span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">template</span>&gt;</span>\\n\\n<span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">script</span> <span class=\\\"hljs-attr\\\">lang</span>=<span class=\\\"hljs-string\\\">&quot;ts&quot;</span>&gt;</span><span class=\\\"language-javascript\\\">\\n<span class=\\\"hljs-keyword\\\">import</span> <span class=\\\"hljs-title class_\\\">Vue</span> <span class=\\\"hljs-keyword\\\">from</span> <span class=\\\"hljs-string\\\">&#x27;vue&#x27;</span>;\\n<span class=\\\"hljs-keyword\\\">import</span> lena <span class=\\\"hljs-keyword\\\">from</span> <span class=\\\"hljs-string\\\">&#x27;./assets/lena.jpeg&#x27;</span>;\\n\\n<span class=\\\"hljs-keyword\\\">export</span> <span class=\\\"hljs-keyword\\\">default</span> <span class=\\\"hljs-title class_\\\">Vue</span>.<span class=\\\"hljs-title function_\\\">extend</span>({\\n  <span class=\\\"hljs-title function_\\\">data</span>(<span class=\\\"hljs-params\\\"></span>) {\\n    <span class=\\\"hljs-keyword\\\">return</span> {\\n      <span class=\\\"hljs-attr\\\">canvasSize</span>: {\\n        <span class=\\\"hljs-attr\\\">width</span>: <span class=\\\"hljs-number\\\">400</span>,\\n        <span class=\\\"hljs-attr\\\">height</span>: <span class=\\\"hljs-number\\\">400</span>,\\n      },\\n      <span class=\\\"hljs-attr\\\">scale</span>: <span class=\\\"hljs-number\\\">1</span>,\\n      <span class=\\\"hljs-attr\\\">hoverColor</span>: <span class=\\\"hljs-string\\\">&#x27;&#x27;</span>,\\n      <span class=\\\"hljs-attr\\\">selectedColor</span>: <span class=\\\"hljs-string\\\">&#x27;&#x27;</span>,\\n    };\\n  },\\n  <span class=\\\"hljs-title function_\\\">mounted</span>(<span class=\\\"hljs-params\\\"></span>) {\\n    <span class=\\\"hljs-keyword\\\">const</span> canvas = <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">$refs</span>.<span class=\\\"hljs-property\\\">canvas</span> <span class=\\\"hljs-keyword\\\">as</span> HTMLCanvasElement;\\n    <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-title function_\\\">loadImgToCanvas</span>(lena, canvas);\\n  },\\n  <span class=\\\"hljs-attr\\\">methods</span>: {\\n    <span class=\\\"hljs-title function_\\\">loadImgToCanvas</span>(<span class=\\\"hljs-params\\\">src: string, canvas: HTMLCanvasElement</span>) {\\n      <span class=\\\"hljs-keyword\\\">const</span> img = <span class=\\\"hljs-keyword\\\">new</span> <span class=\\\"hljs-title class_\\\">Image</span>();\\n      <span class=\\\"hljs-keyword\\\">const</span> { width, height } = <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">canvasSize</span>;\\n      img.<span class=\\\"hljs-property\\\">src</span> = src;\\n      img.<span class=\\\"hljs-property\\\">width</span> = width;\\n      img.<span class=\\\"hljs-property\\\">height</span> = height;\\n      img.<span class=\\\"hljs-property\\\">crossOrigin</span> = <span class=\\\"hljs-string\\\">&#x27;cors&#x27;</span>;\\n      img.<span class=\\\"hljs-property\\\">onload</span> = <span class=\\\"hljs-function\\\">() =&gt;</span> {\\n        <span class=\\\"hljs-keyword\\\">const</span> ctx = canvas.<span class=\\\"hljs-title function_\\\">getContext</span>(<span class=\\\"hljs-string\\\">&#x27;2d&#x27;</span>);\\n        <span class=\\\"hljs-keyword\\\">if</span> (ctx) {\\n          ctx.<span class=\\\"hljs-title function_\\\">drawImage</span>(img, <span class=\\\"hljs-number\\\">0</span>, <span class=\\\"hljs-number\\\">0</span>, width, height);\\n        }\\n      };\\n      img.<span class=\\\"hljs-property\\\">onerror</span> = <span class=\\\"hljs-function\\\"><span class=\\\"hljs-params\\\">error</span> =&gt;</span> <span class=\\\"hljs-variable language_\\\">console</span>.<span class=\\\"hljs-title function_\\\">log</span>(error);\\n    },\\n\\n    <span class=\\\"hljs-title function_\\\">pickColorAtXY</span>(<span class=\\\"hljs-params\\\">\\n      canvas: HTMLCanvasElement,\\n      x: number,\\n      y: number,\\n    </span>) {\\n      <span class=\\\"hljs-keyword\\\">const</span> ctx = canvas.<span class=\\\"hljs-title function_\\\">getContext</span>(<span class=\\\"hljs-string\\\">&#x27;2d&#x27;</span>);\\n      <span class=\\\"hljs-keyword\\\">if</span> (ctx) {\\n        <span class=\\\"hljs-keyword\\\">const</span> imageData = ctx.<span class=\\\"hljs-title function_\\\">getImageData</span>(x, y, <span class=\\\"hljs-number\\\">1</span>, <span class=\\\"hljs-number\\\">1</span>);\\n        <span class=\\\"hljs-keyword\\\">const</span> [r, g, b, a] = imageData.<span class=\\\"hljs-property\\\">data</span>;\\n        <span class=\\\"hljs-keyword\\\">return</span> <span class=\\\"hljs-string\\\">`rgba(<span class=\\\"hljs-subst\\\">${r}</span>, <span class=\\\"hljs-subst\\\">${g}</span>, <span class=\\\"hljs-subst\\\">${b}</span>, <span class=\\\"hljs-subst\\\">${a / <span class=\\\"hljs-number\\\">255</span>}</span>)`</span>;\\n      }\\n      <span class=\\\"hljs-keyword\\\">return</span> <span class=\\\"hljs-string\\\">&#x27;rgba(0,0,0,0)&#x27;</span>;\\n    },\\n\\n    <span class=\\\"hljs-title function_\\\">onmousemove</span>(<span class=\\\"hljs-params\\\">evt: any</span>) {\\n      <span class=\\\"hljs-keyword\\\">const</span> target = evt.<span class=\\\"hljs-property\\\">target</span> <span class=\\\"hljs-keyword\\\">as</span> HTMLCanvasElement;\\n      <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">hoverColor</span> = <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-title function_\\\">pickColorAtXY</span>(target, evt.<span class=\\\"hljs-property\\\">layerX</span>, evt.<span class=\\\"hljs-property\\\">layerY</span>);\\n    },\\n\\n    <span class=\\\"hljs-title function_\\\">onSelect</span>(<span class=\\\"hljs-params\\\">evt: any</span>) {\\n      <span class=\\\"hljs-keyword\\\">const</span> target = evt.<span class=\\\"hljs-property\\\">target</span> <span class=\\\"hljs-keyword\\\">as</span> HTMLCanvasElement;\\n      <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-property\\\">selectedColor</span> = <span class=\\\"hljs-variable language_\\\">this</span>.<span class=\\\"hljs-title function_\\\">pickColorAtXY</span>(target, evt.<span class=\\\"hljs-property\\\">layerX</span>, evt.<span class=\\\"hljs-property\\\">layerY</span>);\\n    },\\n  },\\n});\\n</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">script</span>&gt;</span>\\n\\n<span class=\\\"hljs-tag\\\">&lt;<span class=\\\"hljs-name\\\">style</span> <span class=\\\"hljs-attr\\\">scoped</span> <span class=\\\"hljs-attr\\\">lang</span>=<span class=\\\"hljs-string\\\">&quot;less&quot;</span>&gt;</span><span class=\\\"language-css\\\">\\n<span class=\\\"hljs-selector-class\\\">.canvas-demo-table</span> {\\n  <span class=\\\"hljs-attribute\\\">width</span>: <span class=\\\"hljs-number\\\">100%</span>;\\n  <span class=\\\"hljs-attribute\\\">text-align</span>: center;\\n}\\n</span><span class=\\\"hljs-tag\\\">&lt;/<span class=\\\"hljs-name\\\">style</span>&gt;</span>\\n\""],"sourceRoot":""}