{"version":3,"sources":["webpack:///./src/views/articles/canvas/chapterC02P05.vue?5748","webpack:///./src/views/articles/canvas/chapterC02P05.vue?f7ca","webpack:///./src/views/articles/canvas/chapterC02P05.vue?6467","webpack:///./src/views/articles/canvas/chapterC02P05.vue?35ea","webpack:///./src/views/articles/canvas/chapterC02P05.vue?3492"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","class","active","eraserEnabled","on","brushHandler","eraserHandler","downloadHandler","clearHandler","lineWidth","$event","_l","color","key","strokeStyle","style","backgroundColor","setColor","staticRenderFns","extend","data","canvas","ctx","colorList","mounted","$refs","getContext","autoSetCanvasSize","initCanvasBackground","disableScroll","registerUserEvents","methods","setCanvasSize","defaultPadding","pageWidth","document","documentElement","clientWidth","pageHeight","clientHeight","width","height","window","onresize","drawLine","x1","y1","x2","y2","beginPath","moveTo","lineTo","stroke","closePath","enableDrag","lastPoint","x","y","undefined","body","ontouchstart","addEventListener","e","offsetX","offsetY","clearRect","newPoint","touches","clientX","clientY","downloadImage","filename","a","createElement","href","download","target","appendChild","click","dataURL","toDataURL","changeCtxStrokeStyle","fillStyle","fillRect","preventDefault","component"],"mappings":"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","file":"js/chunk-623a8e32.6db015f0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"demo-whiteboard\"},[_c('canvas',{ref:\"canvas\",attrs:{\"width\":\"400\",\"height\":\"400\"}}),_c('div',{staticClass:\"actions\"},[_c('svg',{staticClass:\"icon\",class:{ active: !_vm.eraserEnabled },on:{\"click\":_vm.brushHandler}},[_c('use',{attrs:{\"xlink:href\":\"#icon-Pencil\"}})]),_c('svg',{staticClass:\"icon\",class:{ active: _vm.eraserEnabled },on:{\"click\":_vm.eraserHandler}},[_c('use',{attrs:{\"xlink:href\":\"#icon-eraser\"}})]),_c('svg',{staticClass:\"icon\",on:{\"click\":_vm.downloadHandler}},[_c('use',{attrs:{\"xlink:href\":\"#icon-save\"}})]),_c('svg',{staticClass:\"icon\",on:{\"click\":_vm.clearHandler}},[_c('use',{attrs:{\"xlink:href\":\"#icon-clear\"}})])]),_c('ul',{staticClass:\"sizes\"},[_c('li',{staticClass:\"size thin action-item\",class:{ active: _vm.lineWidth === 3 },on:{\"click\":function($event){_vm.lineWidth = 3}}}),_c('li',{staticClass:\"size thick action-item\",class:{ active: _vm.lineWidth === 6 },on:{\"click\":function($event){_vm.lineWidth = 6}}})]),_c('ul',{staticClass:\"colors\"},_vm._l((_vm.colorList),function(color){return _c('li',{key:color,staticClass:\"color action-item\",class:{\n        active: color === _vm.strokeStyle\n      },style:({ backgroundColor: color }),on:{\"click\":function($event){return _vm.setColor(color)}}})}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* eslint-disable no-param-reassign */\nimport Vue from 'vue';\n\nexport default Vue.extend({\n  data() {\n    return {\n      eraserEnabled: false,\n      lineWidth: 3,\n      strokeStyle: '',\n      canvas: null as HTMLCanvasElement | null,\n      ctx: null as CanvasRenderingContext2D | null,\n      colorList: ['#000000', '#70FF56', '#FB6164', '#FFE931', '#83FFB6', '#FF7520'],\n    };\n  },\n  mounted() {\n    const canvas = this.$refs.canvas as HTMLCanvasElement;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) { return; }\n    this.canvas = canvas;\n    this.ctx = ctx;\n    this.autoSetCanvasSize(canvas);\n    this.initCanvasBackground(canvas, ctx);\n    this.disableScroll();\n    this.registerUserEvents(canvas, ctx);\n  },\n  methods: {\n    autoSetCanvasSize(canvas: HTMLCanvasElement) {\n      function setCanvasSize() {\n        const defaultPadding = 40;\n        const pageWidth = document.documentElement.clientWidth - defaultPadding;\n        const pageHeight = document.documentElement.clientHeight;\n        canvas.width = pageWidth;\n        canvas.height = pageHeight;\n      }\n      setCanvasSize();\n      // 改变窗口大小重新设置\n      window.onresize = () => {\n        setCanvasSize();\n      };\n    },\n\n    drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number) {\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineWidth = this.lineWidth || 3;\n      ctx.lineTo(x2, y2);\n      ctx.stroke();\n      ctx.closePath();\n    },\n\n    registerUserEvents(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D) {\n      // 鼠标操作\n      let enableDrag = false;\n      let lastPoint = { x: 0, y: 0 };\n      // 特性检测\n      if (document.body.ontouchstart === undefined) {\n        // 非触屏设备\n        canvas.addEventListener('mousedown', (e) => {\n          enableDrag = true;\n          const x = e.offsetX;\n          const y = e.offsetY;\n          if (this.eraserEnabled) {\n            ctx.clearRect(x - 5, y - 5, 10, 10);\n          } else {\n            // 在按下时就要更新 lastPoint, 不然下一次点击会连接到上一条线的 lastPoint\n            lastPoint = { x, y };\n          }\n        });\n        canvas.addEventListener('mousemove', (e) => {\n          if (!enableDrag) { return; }\n\n          const x = e.offsetX;\n          const y = e.offsetY;\n          if (this.eraserEnabled) {\n            ctx.clearRect(x - 5, y - 5, 10, 10);\n          } else {\n            const newPoint = { x, y };\n            this.drawLine(ctx, lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\n            lastPoint = newPoint;\n          }\n        });\n        canvas.addEventListener('mouseup', (e) => {\n          enableDrag = false;\n        });\n      } else {\n        // 触屏设备\n        canvas.addEventListener('touchstart', (e) => {\n          enableDrag = true;\n          const x = e.touches[0].clientX;\n          const y = e.touches[0].clientY;\n          if (this.eraserEnabled) {\n            ctx.clearRect(x - 5, y - 5, 10, 10);\n          } else {\n            // 在按下时就要更新 lastPoint, 不然下一次点击会连接到上一条线的 lastPoint\n            lastPoint = { x, y };\n          }\n        });\n        canvas.addEventListener('touchmove', (e) => {\n          if (!enableDrag) { return; }\n\n          const x = e.touches[0].clientX;\n          const y = e.touches[0].clientY;\n          if (this.eraserEnabled) {\n            ctx.clearRect(x - 5, y - 5, 10, 10);\n          } else {\n            const newPoint = { x, y };\n            this.drawLine(ctx, lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\n            lastPoint = newPoint;\n          }\n        });\n        canvas.addEventListener('touchend', (e) => {\n          enableDrag = false;\n        });\n      }\n    },\n\n    // Save | Download image\n    downloadImage(data: string, filename = 'untitled.jpeg') {\n      const a = document.createElement('a');\n      a.href = data;\n      a.download = filename;\n      a.target = '_blank';\n      document.body.appendChild(a);\n      a.click();\n    },\n\n    eraserHandler() {\n      this.eraserEnabled = true;\n    },\n\n    brushHandler() {\n      this.eraserEnabled = false;\n    },\n\n    clearHandler() {\n      const { ctx, canvas } = this;\n      if (!ctx || !canvas) { return; }\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n    },\n\n    downloadHandler() {\n      const { ctx, canvas } = this;\n      if (!ctx || !canvas) { return; }\n      const dataURL = canvas.toDataURL('image/png');\n      this.downloadImage(dataURL, '我的画-在线画板.png');\n    },\n\n    setColor(color: string) {\n      this.strokeStyle = color;\n      if (this.ctx) {\n        this.changeCtxStrokeStyle(this.ctx, color);\n      }\n    },\n\n    changeCtxStrokeStyle(ctx: CanvasRenderingContext2D, color: string) {\n      ctx.strokeStyle = color;\n    },\n\n    initCanvasBackground(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D) {\n      ctx.fillStyle = 'white';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n    },\n\n    disableScroll() {\n      document.body.addEventListener('touchmove', (e) => {\n        e.preventDefault();\n      });\n    },\n  },\n});\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chapterC02P05.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chapterC02P05.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./chapterC02P05.vue?vue&type=template&id=179984fd&scoped=true&\"\nimport script from \"./chapterC02P05.vue?vue&type=script&lang=ts&\"\nexport * from \"./chapterC02P05.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./chapterC02P05.vue?vue&type=style&index=0&id=179984fd&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"179984fd\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chapterC02P05.vue?vue&type=style&index=0&id=179984fd&lang=less&scoped=true&\""],"sourceRoot":""}